
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../production/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.12">
    
    
      
        <title>Local Deployment - Browsertrix Cloud Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.2505c338.min.css">
      
      
  
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M470.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 256 265.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160zm-352 160 160-160c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L210.7 256 73.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0h-32zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1z"/></svg>');}</style>


    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CRecursive:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Recursive"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="cyan">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#local-deployment" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Browsertrix Cloud Docs" class="md-header__button md-logo" aria-label="Browsertrix Cloud Docs" data-md-component="logo">
      
  <img src="../../assets/brand/btrix-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Browsertrix Cloud Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Local Deployment
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Welcome
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Deploy
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../dev/" class="md-tabs__link">
        Dev
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../user-guide/" class="md-tabs__link">
        User guide
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Browsertrix Cloud Docs" class="md-nav__button md-logo" aria-label="Browsertrix Cloud Docs" data-md-component="logo">
      
  <img src="../../assets/brand/btrix-logo.svg" alt="logo">

    </a>
    Browsertrix Cloud Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Deploy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Deploy
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Local Deployment
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Local Deployment
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing-kubernetes" class="md-nav__link">
    Installing Kubernetes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#launching-browsertrix-cloud-with-helm" class="md-nav__link">
    Launching Browsertrix Cloud with Helm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#waiting-for-cluster-to-start" class="md-nav__link">
    Waiting for Cluster to Start
  </a>
  
    <nav class="md-nav" aria-label="Waiting for Cluster to Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging-pod-issues" class="md-nav__link">
    Debugging Pod Issues
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-the-cluster" class="md-nav__link">
    Updating the Cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uninstalling" class="md-nav__link">
    Uninstalling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-with-local-images" class="md-nav__link">
    Running With Local Images
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../production/" class="md-nav__link">
        Production: Self-Hosted and Cloud
      </a>
    </li>
  

            
          
            
              
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
      
      
      
        <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
          Ansible
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_4">
          <span class="md-nav__icon md-icon"></span>
          Ansible
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ansible/digitalocean/" class="md-nav__link">
        DigitalOcean
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ansible/microk8s/" class="md-nav__link">
        Microk8s
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Dev
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Dev
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/" class="md-nav__link">
        Developer Docs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/docs/" class="md-nav__link">
        Docs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../dev/frontend-dev/" class="md-nav__link">
        Running the Frontend
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          User guide
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          User guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing-kubernetes" class="md-nav__link">
    Installing Kubernetes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#launching-browsertrix-cloud-with-helm" class="md-nav__link">
    Launching Browsertrix Cloud with Helm
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#waiting-for-cluster-to-start" class="md-nav__link">
    Waiting for Cluster to Start
  </a>
  
    <nav class="md-nav" aria-label="Waiting for Cluster to Start">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debugging-pod-issues" class="md-nav__link">
    Debugging Pod Issues
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#updating-the-cluster" class="md-nav__link">
    Updating the Cluster
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#uninstalling" class="md-nav__link">
    Uninstalling
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-with-local-images" class="md-nav__link">
    Running With Local Images
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="local-deployment">Local Deployment<a class="headerlink" href="#local-deployment" title="Permanent link">&para;</a></h1>
<p>To just test out Browsertrix Cloud on your local machine, you'll first need to have a working Kubernetes cluster.</p>
<h2 id="installing-kubernetes">Installing Kubernetes<a class="headerlink" href="#installing-kubernetes" title="Permanent link">&para;</a></h2>
<p>Before running Browsertrix Cloud, you'll need to set up a running Kubernetes cluster.</p>
<p>Today, there are numerous ways to deploy Kubernetes fairly easily, and we recommend trying one of the single-node options, which include Docker Desktop, microk8s, minikube and k3s.</p>
<p>The instructions below assume you have cloned
the <a href="https://github.com/webrecorder/browsertrix-cloud">https://github.com/webrecorder/browsertrix-cloud</a> repository locally,
and have local package managers for your platform (eg. <code>brew</code> for Mac, <code>choco</code> for Windows, etc...) already installed.</p>
<p>Here are some environment specific instructions for setting up a local cluster from different Kubernetes vendors:</p>
<details class="tip">
<summary>Docker Desktop (recommended for Mac and Windows)</summary>
<p>For Mac and Windows, we recommend testing out Browsertrix Cloud using Kubernetes support in Docker Desktop as that will be one of the simplest options.</p>
<ol>
<li>
<p><a href="https://www.docker.com/products/docker-desktop/">Install Docker Desktop</a> if not already installed.</p>
</li>
<li>
<p>From the Dashboard app, ensure <code>Enable Kubernetes</code> is checked from the Preferences screen.</p>
</li>
<li>
<p>Restart Docker Desktop if asked, and wait for it to fully restart.</p>
</li>
<li>
<p>Install <a href="https://helm.sh/">Helm</a>, which can be installed with <code>brew install helm</code> (Mac) or <code>choco install kubernetes-helm</code> (Windows) or following some of the <a href="https://helm.sh/docs/intro/install/">other install options</a></p>
</li>
</ol>
</details>
<details class="tip">
<summary>MicroK8S (recommended for Ubuntu)</summary>
<p>For Ubuntu and other linux distros, we recommend using MicroK8S for both local deployment and production.</p>
<ol>
<li>
<p>Install MicroK8s, by running <code>sudo snap install microk8s --classic</code> <a href="https://microk8s.io/docs/getting-started">see more detailed instructions here</a> or <a href="https://microk8s.io/docs/install-alternatives">alternate installation instructions here</a></p>
</li>
<li>
<p>Install the following addons <code>microk8s enable dns hostpath-storage registry helm3</code>. (For production, also add <code>ingress cert-manager</code> to the list of addons)</p>
</li>
<li>
<p>Wait for add-ons to finish installing with <code>microk8s status --wait-ready</code></p>
</li>
</ol>
<p>Note: microk8s comes with its own version helm, so you don't need to install it separately. Replace <code>helm</code> with <code>microk8s helm3</code> in the subsequent instructions below.</p>
</details>
<details class="tip">
<summary>Minikube (Windows, Mac or Linux)</summary>
<ol>
<li>
<p>Install Minikube <a href="https://minikube.sigs.k8s.io/docs/start/">following installation instructions</a>, eg. <code>brew install minikube</code></p>
</li>
<li>
<p>Install <a href="https://helm.sh/">Helm</a>, which can be installed with <code>brew install helm</code> (Mac) or <code>choco install kubernetes-helm</code> (Windows) or following some of the <a href="https://helm.sh/docs/intro/install/">other install options</a></p>
</li>
<li>
<p>Run the Helm command as described above.</p>
</li>
<li>
<p>Mac Only: To access Browsertrix Cloud running in minikube on a mac, run <code>minikube service browsertrix-cloud-frontend --url</code> and then access Browsertrix Cloud via the provided URL. This is needed as Browsertrix Cloud is running in a VM.</p>
</li>
</ol>
</details>
<details class="tip">
<summary>K3S (recommended for non-Ubuntu Linux)</summary>
<ol>
<li>
<p>Install K3s <a href="https://docs.k3s.io/quick-start">as per the instructions</a></p>
</li>
<li>
<p>Install <a href="https://helm.sh/">Helm</a>, which can be installed with <code>brew install helm</code> (Mac) or <code>choco install kubernetes-helm</code> (Windows) or following some of the <a href="https://helm.sh/docs/intro/install/">other install options</a></p>
</li>
<li>
<p>Set <code>KUBECONFIG</code> to point to the config for K3S: <code>export KUBECONFIG=/etc/rancher/k3s/k3s.yaml</code> to ensure Helm will use the correct version.</p>
</li>
</ol>
</details>
<h2 id="launching-browsertrix-cloud-with-helm">Launching Browsertrix Cloud with Helm<a class="headerlink" href="#launching-browsertrix-cloud-with-helm" title="Permanent link">&para;</a></h2>
<p>Once you have a running Kubernetes cluster with one of the options above, and Helm 3 installed, you can then run from the Browsertrix Cloud repo directory:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>helm upgrade --install -f ./chart/values.yaml -f ./chart/examples/local-config.yaml btrix ./chart/
</code></pre></div>
<p>The local setup includes the full Browsertrix Cloud system, with frontend, backend api, db (via MongoDB) and storage (via Minio)</p>
<p>An admin user with name <code>admin@example.com</code> and password <code>PASSW0RD!</code> will be automatically created.</p>
<p>This config uses the standard config (<code>./chart/values.yaml</code>) with a couple additional settings for local deployment (<code>./chart/examples/local-config.yaml</code>). With Helm, additional YAML files can be added to further override previous settings.</p>
<p>These settings can be changed in <a href="https://github.com/webrecorder/browsertrix-cloud/blob/main/chart/examples/local-config.yaml">charts/examples/local-config.yaml</a>.</p>
<p>Note that the admin user and password will not be reset after creation.</p>
<h2 id="waiting-for-cluster-to-start">Waiting for Cluster to Start<a class="headerlink" href="#waiting-for-cluster-to-start" title="Permanent link">&para;</a></h2>
<p>After running the helm command, you should see something like:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>Release &quot;btrix&quot; does not exist. Installing it now.
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>NAME: btrix
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>LAST DEPLOYED: &lt;time&gt;
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>NAMESPACE: default
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>STATUS: deployed
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>REVISION: 1
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>TEST SUITE: None
</code></pre></div>
<p>After that, especially on first run, it may take a few minutes for the Browsertrix Cloud cluster to start, as all images need to be downloaded locally.</p>
<p>You can try running the command: <code>kubectl wait --for=condition=ready pod --all --timeout=300s</code> to wait for all pods to be initialized.</p>
<p>The command will exit when all pods have been loaded, or if there is an error and it times out.</p>
<p>If the command succeeds, you should be able to access Browsertrix Cloud by loading: <strong><a href="http://localhost:30870/">http://localhost:30870/</a></strong> in your browser.</p>
<h3 id="debugging-pod-issues">Debugging Pod Issues<a class="headerlink" href="#debugging-pod-issues" title="Permanent link">&para;</a></h3>
<p>If this command fails, you can also run <code>kubectl get pods</code> to see the status of each of the pods.</p>
<p>There should be 4 pods listed: backend, frontend, minio and mongodb. If any one is not ready for a while, something may be wrong.</p>
<p>To get more details about why a pod has not started, you can run <code>kubectl describe &lt;podname&gt;</code> and see the latest status at the bottom.</p>
<p>Often, the error may be obvious, such as failed to pull an image.</p>
<p>If the pod is running, or previously ran, you can also get the logs from the container by running <code>kubectl logs &lt;podname&gt;</code></p>
<p>The outputs of these commands will be helpful if you'd like to report an issue <a href="https://github.com/webrecorder/browsertrix-cloud/issues">on GitHub</a></p>
<h2 id="updating-the-cluster">Updating the Cluster<a class="headerlink" href="#updating-the-cluster" title="Permanent link">&para;</a></h2>
<p>To update the cluster, re-run the same command again, which will pull the latest images. In this way, you can upgrade to the latest release of Browsertrix Cloud. The upgrade will preserve the database and current archives.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>helm upgrade --install -f ./chart/values.yaml -f ./chart/examples/local-config.yaml btrix ./chart/
</code></pre></div>
<h2 id="uninstalling">Uninstalling<a class="headerlink" href="#uninstalling" title="Permanent link">&para;</a></h2>
<p>To uninstall, run <code>helm uninstall btrix</code>.</p>
<p>By default, the database + storage volumes are not automatically deleted, so you can run <code>helm upgrade...</code> again to restart the cluster in its current state.</p>
<p>To fully delete all persistent data created in the cluster, also run <code>kubectl delete pvc --all</code> after uninstalling.</p>
<h2 id="running-with-local-images">Running With Local Images<a class="headerlink" href="#running-with-local-images" title="Permanent link">&para;</a></h2>
<p>By default, this setup will pull the latest release of Browsertrix Cloud. However, if you are developing locally, you may want to use your local images instead.</p>
<p>First, open <code>./chart/examples/local-config.yaml</code> and add the following, which will ensure only local images are used:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>backend_pull_policy: &quot;Never&quot;
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>frontend_pull_policy: &quot;Never&quot;
</code></pre></div>
<p>Now, rebuild either the backend and/or frontend images locally. The exact process depends on the Kubernetes deployment in use:</p>
<details class="tip">
<summary>Docker Desktop</summary>
<p>Rebuild the local images by running <code>./scripts/build-backend.sh</code> and/or <code>./scripts/build-frontend.sh</code> scripts to build the images in the local Docker.</p>
</details>
<details class="tip">
<summary>MicroK8S</summary>
<p>MicroK8s uses its own container registry, running on port 32000. </p>
<ol>
<li>
<p>Set <code>export REGISTRY=localhost:32000/</code> and then run <code>./scripts/build-backend.sh</code> and/or <code>./scripts/build-frontend.sh</code> to rebuild the images into the MicroK8S registry. </p>
</li>
<li>
<p>In <code>./chart/examples/local-config.yaml</code>, uncomment out one or both of the following lines to use the local images:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>backend_image: &quot;localhost:32000/webrecorder/browsertrix-backend:latest&quot;
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>frontend_image: &quot;localhost:32000/webrecorder/browsertrix-frontend:latest&quot;
</code></pre></div>
</details>
<details class="tip">
<summary>Minikube</summary>
<p>Minikube comes with its own image builder to update the images used in Minikube.</p>
<p>To build the backend image, run:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>minikube image build -t webrecorder/browsertrix-backend:latest ./backend
</code></pre></div>
<p>To build a local frontend image, run:
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>minikube image build -t webrecorder/browsertrix-frontend:latest ./frontend
</code></pre></div></p>
</details>
<details class="tip">
<summary>K3S</summary>
<p>K3S uses <code>containerd</code> by default. To use local images, they need to be imported after rebuilding.</p>
<ol>
<li>
<p>Rebuild the images with Docker by running by running <code>./scripts/build-backend.sh</code> and/or <code>./scripts/build-frontend.sh</code> scripts. (Requires Docker to be installed as well).</p>
</li>
<li>
<p>Serializer the images to .tar:</p>
</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>docker save webrecorder/browsertrix-backend:latest &gt; ./backend.tar
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>docker save webrecorder/browsertrix-frontend:latest &gt; ./frontend.tar
</code></pre></div>
<ol>
<li>Import images into k3s containerd:</li>
</ol>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>k3s ctr images import --base-name webrecorder/browsertrix-backend:latest ./backend.tar
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>k3s ctr images import --base-name webrecorder/browsertrix-frontend:latest ./frontend.tar
</code></pre></div>
</details>
<p>Once the images have been built and any other config changes made per the above instructions, simply run the <code>helm upgrade...</code> command again to restart with local images.</p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.instant"], "search": "../../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.4b2c34cd.min.js"></script>
      
    
  </body>
</html>